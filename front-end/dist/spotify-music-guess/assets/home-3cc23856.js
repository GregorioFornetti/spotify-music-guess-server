var _e=Object.defineProperty;var Me=(e,t,s)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[t]=s;var r=(e,t,s)=>(Me(e,typeof t!="symbol"?t+"":t,s),s);import{a as Se}from"./configs-0ede03f3.js";/* empty css              */import{a as H,b as P,U as u,B as Ae,M as De}from"./addLoading-ff09a8db.js";const Re={"empty-page":"none","home-page":"flex","playlist-info-page":"flex","rounds-mode-game-page":"block","credits-page":"block","tests-page":"block"};function T(e){var s;const t=(s=document.getElementById("main"))==null?void 0:s.children;if(t)for(let n=0;n<t.length;n++){const i=t[n];i.style.display="none",i.id===e&&(i.style.display=Re[e])}}function He(e,t,s){var i;const n=(i=document.getElementById(e))==null?void 0:i.children;if(n)for(let a=0;a<n.length;a++){const o=n[a];o.style.display="none",o.id===t&&(o.style.display=s)}}const ee="([A-Za-z0-9]{22})",$e=new RegExp(`^${ee}$`),he=new RegExp(`^spotify:playlist:${ee}$`),ge=new RegExp(`https://open.spotify.com/playlist/${ee}(\\?si=.*)?`),fe=new RegExp(`^${ge.source}$`),Fe=new RegExp("^https://spotify.(app.)?link/[A-Za-z0-9]{11}$");function Ue(e){return $e.test(e)}function Oe(e){return he.test(e)}function qe(e){return fe.test(e)}function Qe(e){return Fe.test(e)}function je(e){return e.match(he)[1]}function Ee(e){return e.match(fe)[1]}async function Ve(e){const t=`https://spotify.app.link/${e.split("/")[3]}`,i=(await(await fetch(`${Se}/get-redirect-response?url=${t}`,{method:"GET"})).text()).match(ge)[0];return Ee(i)}function ze(e){if(e=e.trim(),Oe(e))return Promise.resolve(je(e));if(qe(e))return Promise.resolve(Ee(e));if(Qe(e))return H(Ve,e);if(Ue(e))return Promise.resolve(e);throw new Error("URI, URL ou ID inválido.")}class c{static reset(){this.resetCorrectAnswerCount(),this.resetRoundNumber(),this.resetCurrentTime(),this.resetExtraTriesCount(),this.resetRoundsHistory()}static get playlist(){return this._playlist}static set playlist(t){this._playlist=t}static get playlistId(){return this._playlistId}static set playlistId(t){this._playlistId=t}static get roundNumber(){return this._roundNumber}static resetRoundNumber(){this._roundNumber=1}static increaseRoundNumber(){if(this._totalRounds<=this._roundNumber)throw new Error("Número do round não pode ser maior que o número total de rounds");this._roundNumber++}static get totalRounds(){return this._totalRounds}static set totalRounds(t){this._totalRounds=t}static get correctAnswersCount(){return this._correctAnswerCount}static resetCorrectAnswerCount(){this._correctAnswerCount=0}static increaseCorrectAnswerCount(){if(this._totalRounds<=this._correctAnswerCount)throw new Error("Número de acertos não pode ser maior que o número total de rounds");this._correctAnswerCount++}static get musicPos(){return this._musicPos}static set musicPos(t){this._musicPos=t}static get musicPlaytime(){return this._musicPlaytime}static set musicPlaytime(t){this._musicPlaytime=t}static get musicsQnt(){return this._musicsQnt}static set musicsQnt(t){this._musicsQnt=t}static get extraTries(){return this._extraTries}static set extraTries(t){this._extraTries=t}static get currentTime(){return this._currentTime}static resetCurrentTime(){this._currentTime=0,this.roundCurrentTime=0}static increaseCurrentTime(){this._currentTime++,this.roundCurrentTime++}static get extraTriesCount(){return this._extraTriesCount}static resetExtraTriesCount(){this._extraTriesCount=0,this.roundExtraTriesCount=0}static increaseExtraTriesCount(){this._extraTriesCount++,this.roundExtraTriesCount++}static get roundsHistory(){return this._roundsHistory}static resetRoundsHistory(){this._roundsHistory=[]}static addRoundHistory(t,s){this.extraTries?this._roundsHistory.push({timeSpent:this.roundCurrentTime,correctMusic:t,guessedMusic:s}):this._roundsHistory.push({timeSpent:this.roundCurrentTime,correctMusic:t,guessedMusic:s,extraTriesCount:this.roundExtraTriesCount}),this.roundCurrentTime=0,this.roundExtraTriesCount=0}static get score(){return Math.round(Math.max(this._correctAnswerCount*100*(8/(this._musicPlaytime+3))-(this._currentTime+this._extraTriesCount*10),25*this._correctAnswerCount))}static get incorrectAnswerCount(){return this._totalRounds-this._correctAnswerCount}static get isPremiumMode(){return this._isPremiumMode}static set isPremiumMode(t){this._isPremiumMode=t}}r(c,"_playlist"),r(c,"_playlistId"),r(c,"_roundNumber"),r(c,"_correctAnswerCount"),r(c,"_totalRounds"),r(c,"_musicPos"),r(c,"_musicPlaytime"),r(c,"_musicsQnt"),r(c,"_extraTries"),r(c,"_currentTime"),r(c,"_extraTriesCount"),r(c,"_roundsHistory"),r(c,"_isPremiumMode"),r(c,"roundCurrentTime"),r(c,"roundExtraTriesCount");const Ge={"configs-rounds-subpage":"flex","song-guess-rounds-subpage":"flex","song-result-rounds-subpage":"flex","final-result-rounds-subpage":"block"};function Z(e){He("rounds-mode-game-page",e,Ge[e])}function de(e){const t=document.createElement("div");t.classList.add("music");const s=document.createElement("img");s.classList.add("music-image");const n=document.createElement("p");n.classList.add("music-name"),n.innerText=e.name;const i=document.createElement("p");return i.classList.add("music-artist"),e.type==="track"?(e.album.images.length!==0&&s.setAttribute("src",e.album.images[0].url),i.innerText=e.artists[0].name):e.type==="episode"&&(e.images.length!==0&&s.setAttribute("src",e.images[0].url),i.innerText=e.show.name),t.appendChild(s),t.appendChild(n),t.appendChild(i),t}function W(e){const t=Math.floor(e/3600),s=Math.floor(e%(60*60)/60),n=e%60;return t?`${String(t).padStart(2,"0")}:${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}`:`${String(s).padStart(2,"0")}:${String(n).padStart(2,"0")}`}function me(e,t){const s=document.createElement("div"),n=document.createElement("p");n.classList.add("music-round-history-type"),t===!0?n.innerText="Música escolhida":n.innerText="Música sorteada";const i=document.createElement("img");i.classList.add("img-fluid"),i.classList.add("music-image-round-history");const a=document.createElement("p");a.classList.add("music-name-round-history"),a.innerText=e.name;const o=document.createElement("p");return o.classList.add("music-artist-round-history"),e.type==="track"?(e.album.images.length!==0&&i.setAttribute("src",e.album.images[0].url),o.innerText=e.artists[0].name):e.type==="episode"&&(e.images.length!==0&&i.setAttribute("src",e.images[0].url),o.innerText=e.show.name),s.appendChild(n),s.appendChild(i),s.appendChild(a),s.appendChild(o),s}function Je(e){const t=document.createElement("div");t.classList.add("carousel-item"),t.classList.add("rounds-mode-history"),e.guessedMusic.id===e.correctMusic.id?t.classList.add("rounds-mode-history-accepted"):t.classList.add("rounds-mode-history-rejected");const s=document.createElement("div");s.classList.add("timer"),s.innerText=`${W(e.timeSpent)}`;const n=document.createElement("div");n.classList.add("music-round-history");const i=document.createElement("div");i.classList.add("row"),i.classList.add("music-round-history-image");const a=me(e.guessedMusic,!0);a.classList.add("col-lg-6"),a.classList.add("col-xl-5"),e.guessedMusic.id===e.correctMusic.id?a.classList.add("music-round-history-choice-ac"):a.classList.add("music-round-history-choice-re");const o=me(e.correctMusic,!1);return o.classList.add("col-lg-6"),o.classList.add("col-xl-5"),o.classList.add("music-round-history-correct"),i.appendChild(o),i.appendChild(a),n.appendChild(i),t.appendChild(s),t.appendChild(n),t}function Ze(){document.getElementById("rounds-mode-score").innerText=c.score.toString(),document.getElementById("rounds-mode-correct-count").innerText=c.correctAnswersCount.toString(),document.getElementById("rounds-mode-incorrect-count").innerText=c.incorrectAnswerCount.toString(),document.getElementById("rounds-mode-total-rounds").innerText=c.totalRounds.toString(),document.getElementById("rounds-mode-total-time").innerText=W(c.currentTime),document.getElementById("rounds-mode-extra-tries-count").innerText=c.extraTriesCount.toString(),c.extraTries,document.getElementById("rounds-mode-extra-tries").style.display="none";const e=document.getElementById("carousel-inner");e.innerHTML="";const t=document.getElementById("nslides");t.innerHTML="";var s=0;for(let n of c.roundsHistory){const i=document.createElement("button"),a=Je(n);t.appendChild(i),i.dataset.bsTarget="#carouselExampleCaptions",i.dataset.bsSlideTo=s.toString(),s==0&&(i.classList.add("active"),i.setAttribute("aria-current","true"),a.classList.add("active")),i.setAttribute("aria-label",`Slide ${s+1}`),e.appendChild(a),s++}Z("final-result-rounds-subpage")}document.addEventListener("DOMContentLoaded",()=>{var e,t,s;(e=document.getElementById("final-result-return"))==null||e.addEventListener("click",()=>{T("home-page")}),(t=document.getElementById("play-again-rounds-mode-new-configs"))==null||t.addEventListener("click",()=>{c.reset(),Te()}),(s=document.getElementById("play-again-rounds-mode-same-configs"))==null||s.addEventListener("click",()=>{c.reset(),Ce()})});function We(e,t){c.addRoundHistory(e,t),e.id===t.id?(document.getElementById("song-result-message").innerText="Você acertou !",document.getElementById("song-result-message").classList.add("music-round-subpage-choice-ac"),document.getElementById("song-result-message").classList.remove("music-round-subpage-choice-re"),document.getElementById("music-title-resposta").classList.add("music-round-subpage-choice-ac"),document.getElementById("music-title-resposta").classList.remove("music-round-subpage-choice-re"),c.increaseCorrectAnswerCount()):(document.getElementById("song-result-message").innerText="Você errou !",document.getElementById("song-result-message").classList.add("music-round-subpage-choice-re"),document.getElementById("song-result-message").classList.remove("music-round-subpage-choice-ac"),document.getElementById("music-title-resposta").classList.add("music-round-subpage-choice-re"),document.getElementById("music-title-resposta").classList.remove("music-round-subpage-choice-ac")),document.getElementById("song-result-current-round").innerText=c.roundNumber.toString(),document.getElementById("song-result-total-rounds").innerText=c.totalRounds.toString();const s=document.getElementById("song-result-correct-song");s.innerHTML="";const n=de(e);n.getElementsByClassName("music-image")[0].classList.add("img-fluid"),n.getElementsByClassName("music-image")[0].classList.add("music-image-subresult"),n.getElementsByClassName("music-name")[0].classList.add("music-name-subresult"),n.getElementsByClassName("music-artist")[0].classList.add("music-artist-subresult"),n.getElementsByClassName("music-image")[0].classList.add("music-round-subpage"),n.getElementsByClassName("music-name")[0].classList.add("music-round-subpage"),n.getElementsByClassName("music-artist")[0].classList.add("music-round-subpage"),s.appendChild(n);const i=document.getElementById("song-result-guessed-song");i.innerHTML="";const a=de(t);a.getElementsByClassName("music-image")[0].classList.add("img-fluid"),a.getElementsByClassName("music-image")[0].classList.add("music-image-subresult"),a.getElementsByClassName("music-name")[0].classList.add("music-name-subresult"),a.getElementsByClassName("music-artist")[0].classList.add("music-artist-subresult"),e.id===t.id?(a.getElementsByClassName("music-name")[0].classList.add("music-round-subpage-choice-ac"),a.getElementsByClassName("music-name")[0].classList.remove("music-round-subpage-choice-re"),a.getElementsByClassName("music-artist")[0].classList.add("music-round-subpage-choice-ac"),a.getElementsByClassName("music-artist")[0].classList.remove("music-round-subpage-choice-re")):(a.getElementsByClassName("music-name")[0].classList.add("music-round-subpage-choice-re"),a.getElementsByClassName("music-name")[0].classList.remove("music-round-subpage-choice-ac"),a.getElementsByClassName("music-artist")[0].classList.add("music-round-subpage-choice-re"),a.getElementsByClassName("music-artist")[0].classList.remove("music-round-subpage-choice-ac")),i.appendChild(a),Z("song-result-rounds-subpage")}document.addEventListener("DOMContentLoaded",()=>{var e;(e=document.getElementById("song-result-next"))==null||e.addEventListener("click",()=>{c.roundNumber===c.totalRounds?Ze():(c.increaseRoundNumber(),ve())})});function te(e){let t=[...e];for(let s=t.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[t[s],t[n]]=[t[n],t[s]]}return t}async function Xe(){await fetch("https://api.spotify.com/v1/me/player/pause",{method:"PUT",headers:u.accessTokenHeader})}function se(e){return P(Xe,e)}async function Ke(e,t,s){let n=0;return s&&(n=s),await fetch("https://api.spotify.com/v1/me/player/play",{method:"PUT",headers:u.accessTokenHeader,body:JSON.stringify({uris:[t],position_ms:n})}),window.setTimeout(()=>{se()},e*1e3)}async function Ye(e,t,s,n){return P(Ke,n,e,t,s)}class ne{constructor(t,s,n){r(this,"musicFullDuration");r(this,"trackURI");r(this,"musicNumber");r(this,"musicPlaytimes");r(this,"currentIndex");r(this,"musicPlaytime");r(this,"timeoutId");this.musicNumber=s,this.currentIndex=0,this.musicPlaytimes=[],this.musicFullDuration=t.tracks.items[this.musicNumber].track.duration_ms,this.trackURI=t.tracks.items[this.musicNumber].track.uri,this.musicPlaytime=n,this.constructPlaytimes()}async play(){if(!this.finished){let t=this.musicPlaytime;this.musicPlaytimes[this.currentIndex]+t*1e3>this.musicFullDuration&&(t=(this.musicFullDuration-this.musicPlaytimes[this.currentIndex])/1e3-.01),this.timeoutId=await Ye(t,this.trackURI,this.musicPlaytimes[this.currentIndex],!0),this.currentIndex+=1}}pause(){clearTimeout(this.timeoutId),se(!0)}get finished(){return this.currentIndex>=this.musicPlaytimes.length}}class et extends ne{constructPlaytimes(){this.musicPlaytimes.push(0);let t=this.musicPlaytime*1e3;for(;t<this.musicFullDuration;)this.musicPlaytimes.push(t),t+=this.musicPlaytime*1e3;this.musicPlaytimes=te(this.musicPlaytimes)}close(){}}class tt extends ne{constructPlaytimes(){this.musicPlaytimes.push(0);let t=this.musicPlaytime*1e3;for(;t<this.musicFullDuration;)this.musicPlaytimes.push(t),t+=this.musicPlaytime*1e3}close(){}}class st extends ne{constructor(s,n,i){super(s,n,i);r(this,"playerElement");this.playerElement=this.createPlayerElement(s),this.musicFullDuration=3e4}createPlayerElement(s){const n=s.tracks.items[this.musicNumber].track,i=document.createElement("audio");i.style.display="none";const a=document.createElement("source");return n.type==="track"?a.src=n.preview_url:n.type==="episode"&&(a.src=n.audio_preview_url),a.type="audio/mpeg",i.appendChild(a),document.body.appendChild(i),i}constructPlaytimes(){this.musicPlaytimes.push(0);let s=this.musicPlaytime*1e3;for(;s<this.musicFullDuration;)this.musicPlaytimes.push(s),s+=this.musicPlaytime*1e3}async play(){this.finished||(this.playerElement.play(),setTimeout(()=>{this.playerElement.pause()},this.musicPlaytime*1e3))}pause(){this.playerElement.pause()}close(){this.playerElement.remove()}}function nt(e,t){return t.filter(s=>s.track.name.toLowerCase().includes(e.toLowerCase()))}function it(e,t){return t.filter(s=>s.track.type==="episode"?s.track.show.name.toLowerCase().includes(e.toLowerCase()):s.track.type==="track"?s.track.artists[0].name.toLowerCase().includes(e.toLowerCase()):!1)}function at(e,t,s,n){return nt(e,ct(s,it(t,n)))}function ct(e,t){return t.filter(s=>s.track.type==="track"?s.track.album.name.toLowerCase().includes(e.toLowerCase()):s.track.type==="episode"?s.track.show.name.toLowerCase().includes(e.toLowerCase()):!1)}function be(e,t,s){const n=document.createElement("div");n.className="playlist-container";const i=document.createElement("table");i.className="playlist-table";const a=document.createElement("thead");a.className="playlist-head";const o=document.createElement("tr");o.className="desktop",o.innerHTML=`
        <th></th>
        <th>Nome</th>
        <th>Artista</th>
        <th>Álbum</th>
    `,a.appendChild(o);const d=document.createElement("tr");d.className="desktop";const l=document.createElement("td"),m=document.createElement("input");m.placeholder="Nome",l.appendChild(m);const f=document.createElement("td"),y=document.createElement("input");y.placeholder="Artista",f.appendChild(y);const h=document.createElement("td"),g=document.createElement("input");g.placeholder="Álbum",h.appendChild(g),d.appendChild(document.createElement("td")),d.appendChild(l),d.appendChild(f),d.appendChild(h),a.appendChild(d);const p=document.createElement("tr");p.className="mobile";const B=document.createElement("td"),C=document.createElement("div");C.className="input-group mb-3";const E=document.createElement("button");E.className="playlist-dropdown-btn btn btn-outline-secondary dropdown-toggle",E.dataset.bsToggle="dropdown",E.ariaExpanded="false",E.innerHTML="Nome";const w=document.createElement("ul");w.className="dropdown-menu";const D=document.createElement("li"),x=document.createElement("a");x.className="playlist-dropdown-item dropdown-item",x.innerHTML="Nome",D.appendChild(x);const N=document.createElement("li"),U=document.createElement("a");U.className="playlist-dropdown-item dropdown-item",U.innerHTML="Artista",N.appendChild(U);const oe=document.createElement("li"),O=document.createElement("a");O.className="playlist-dropdown-item dropdown-item",O.innerHTML="Álbum",oe.appendChild(O),w.appendChild(D),w.appendChild(N),w.appendChild(oe);const I=document.createElement("input");I.placeholder="Filtro",C.appendChild(E),C.appendChild(w),C.appendChild(I),B.appendChild(C),p.appendChild(B),a.appendChild(p);const q=document.createElement("tbody");q.className="playlist-body";let Q,v=null;const le=k=>{for(let b of k){if(!b.track.is_playable)continue;let _=ot(b.track);b.track===Q&&(_.classList.add("selected"),v=_),t&&(_.classList.add("clickable"),_.addEventListener("click",()=>{if(t(b.track),Q===b.track){s&&s(b.track),v==null||v.classList.remove("selected"),v=null,Q=null;return}v&&v.classList.remove("selected"),v=_,Q=b.track,v.classList.add("selected")})),q.appendChild(_)}};let j="name";const L={name:{name:"Nome",value:"",input:m},artist:{name:"Artista",value:"",input:y},album:{name:"Album",value:"",input:g}},re=()=>{q.innerHTML="",le(at(L.name.value,L.artist.value,L.album.value,e.tracks.items))},Ne=()=>{L[j].value=I.value,L[j].input.value=I.value,re()},X=k=>{const b=L[k].input.value;L[k].value=b,k===j&&(I.value=b),re()},K=k=>{j=k,E.innerHTML=L[k].name,I.value=L[k].value};return le(e.tracks.items),x.addEventListener("click",()=>{K("name")}),U.addEventListener("click",()=>{K("artist")}),O.addEventListener("click",()=>{K("album")}),m.addEventListener("input",()=>{X("name")}),y.addEventListener("input",()=>{X("artist")}),g.addEventListener("input",()=>{X("album")}),I.addEventListener("input",Ne),i.appendChild(a),i.appendChild(q),n.appendChild(i),n}function ot(e){const t=document.createElement("tr"),s=document.createElement("td");s.classList.add("album-img");const n=document.createElement("img");n.classList.add("playlist-img");const i=document.createElement("td");i.classList.add("name");const a=document.createElement("span");a.innerText=e.name;const o=document.createElement("td");o.classList.add("artist");const d=document.createElement("span"),l=document.createElement("td");l.classList.add("album");const m=document.createElement("span");return e.type==="track"?(e.album.images.length!==0&&n.setAttribute("src",e.album.images[0].url),d.innerText=e.artists[0].name,m.innerText=e.album.name):e.type==="episode"&&(e.images.length!==0&&n.setAttribute("src",e.images[0].url),d.innerText=e.show.name,m.innerText=e.show.publisher),s.appendChild(n),i.appendChild(a),o.appendChild(d),l.appendChild(m),t.appendChild(s),t.appendChild(i),t.appendChild(o),t.appendChild(l),t}var $=null,A,V,F,z,G=-1;async function Ce(){A=te(c.playlist.playableIndexes),$=null;const e=document.getElementById("song-guess-hear-next");c.extraTries?e.disabled=!1:e.disabled=!0;const t=document.getElementById("rounds-mode-timer");t.innerHTML=W(0),G!==-1&&clearInterval(G),await ve()}async function ve(){if(c.playlist.tracks.items.length===c.musicsQnt)z=c.playlist.tracks.items;else{let s=[A[c.roundNumber-1]],n=[...A];n.splice(c.roundNumber-1,1),n=te(n);for(let i=0;i<c.musicsQnt-1;i++)s.push(n[i]);s.sort(),console.log(s),console.log(c.playlist.tracks.items),z=s.map(i=>c.playlist.tracks.items[i])}console.log(z);const e=structuredClone(c.playlist);e.tracks.items=z,lt(e),c.isPremiumMode?c.musicPos==="random"?V=et:c.musicPos==="start"&&(V=tt):V=st,F=new V(c.playlist,A[c.roundNumber-1],c.musicPlaytime),await F.play();const t=document.getElementById("rounds-mode-timer");G=window.setInterval(()=>{c.increaseCurrentTime(),t.innerHTML=W(c.currentTime)},1e3),Z("song-guess-rounds-subpage")}function lt(e){const t=document.getElementById("playlist-tracks-list-game");t.innerHTML="",t.appendChild(be(e,s=>{$=s},s=>{Le(s)}))}function Le(e){clearInterval(G),console.log("número da musica",A[c.roundNumber-1]),We(c.playlist.tracks.items[A[c.roundNumber-1]].track,e),$=null,F.pause(),F.close()}document.addEventListener("DOMContentLoaded",()=>{var e,t;(e=document.getElementById("song-guess-submit"))==null||e.addEventListener("click",()=>{$&&Le($)}),(t=document.getElementById("song-guess-hear-next"))==null||t.addEventListener("click",()=>{F.play()})});class rt extends Ae{constructor(t,s,n,i,a,o,d){const l=document.createElement("div");l.className="modal fade",l.id=t,l.tabIndex=-1,l.ariaLabel=s,l.ariaHidden="true",l.dataset.bsTheme="dark",n||(l.dataset.bsBackdrop="static");const m=document.createElement("div");m.className="modal-dialog",i&&m.classList.add("modal-dialog-centered"),a&&m.classList.add(`modal-${a}`),d&&(d==="always"?m.classList.add("modal-fullscreen"):m.classList.add(`modal-fullscreen-${d}-down`));const f=document.createElement("div");f.className="modal-content visible-modal-content";const y=document.createElement("div");if(y.className="modal-header",y.innerHTML=`<h2 class="modal-title fs-5 h1">${s}</h2>`,n){const p=document.createElement("button");p.type="button",p.className="btn-close",p.ariaLabel="close",p.dataset.bsDismiss="modal",y.appendChild(p)}const h=document.createElement("div");h.className="modal-body",o&&h.appendChild(o);const g=document.createElement("div");g.className="modal-footer",f.appendChild(y),f.appendChild(h),f.appendChild(g),m.appendChild(f),l.appendChild(m),document.addEventListener("DOMContentLoaded",()=>{document.body.appendChild(l)}),super(new De(l),l,h)}}async function dt(){return fetch("https://api.spotify.com/v1/me/player/devices",{headers:u.accessTokenHeader,method:"GET"}).then(e=>e.json()).then(e=>e.devices)}async function ke(e){return P(dt,e)}function we(e){const t=document.createElement("div");t.classList.add("device");const s=document.createElement("div");s.classList.add("device-is-selected-container");const n=document.createElement("p");n.classList.add("device-is-selected-text"),e.is_active&&(t.classList.add("selected"),n.innerText="Dispositivo seleccionado"),s.appendChild(n),t.appendChild(s);const i=document.createElement("div");i.classList.add("device-icon-container");const a=document.createElement("i");e.type==="Computer"?a.className="bi bi-laptop":e.type==="Smartphone"?a.className="bi bi-phone":e.type==="Speaker"&&(a.className="bi bi-speaker"),i.appendChild(a),t.appendChild(i);const o=document.createElement("div");o.classList.add("device-name-container");const d=document.createElement("p");return d.classList.add("device-name"),d.innerText=e.name,o.appendChild(d),t.appendChild(o),t}async function mt(e){return fetch("https://api.spotify.com/v1/me/player",{headers:u.accessTokenHeader,method:"PUT",body:JSON.stringify({device_ids:[e]})})}async function xe(e,t){return P(mt,t,e)}const M=new rt("deviceSelectedModal","modal-devices",!1,!0);var R;class ut{static show(t){ke().then(s=>{if(console.log(s.length),s.length<1){R=document.createElement("div");var n=document.createElement("p");R.className="mensagem-devices",n.textContent="nenhum dispositivo encontrado, favor abrir o spotfy.",R.appendChild(n);const i=document.createElement("button");i.innerHTML="recarregar devices",i.addEventListener("click",()=>{M.hide(),this.show(t)}),R.appendChild(i),M.addContent(R),M.show()}else{const i=document.createElement("div");for(const a of s){const o=we(a);o.addEventListener("click",async()=>{a.id&&xe(a.id).then(()=>{M.hide(),t()})}),i.appendChild(o)}s.some(a=>a.is_active)?t():(M.addContent(i),M.show())}})}}function Te(){Ie(document.getElementById("configs-rounds-form"));const e=c.playlist.playableIndexes.length;document.getElementById("configs-rounds-rounds-number").setAttribute("max",e.toString());const s=document.getElementById("configs-rounds-music-qnt");s.setAttribute("max",e.toString()),s.setAttribute("value",e.toString()),Z("configs-rounds-subpage")}function Y(e){const t=document.getElementById("music-pos-init"),s=document.getElementById("music-pos-random");e?(t.disabled=!1,t.checked=!0,s.disabled=!1):(t.disabled=!0,t.checked=!1,s.disabled=!0,s.checked=!1)}function Ie(e){const t=document.getElementById("input-premium");e.reset(),u.isLogged?(t.checked=!0,t.disabled=!1,Y(!0)):(t.checked=!1,t.disabled=!0,Y(!1))}document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("input-premium");e.addEventListener("input",()=>{Y(e.checked)});const t=document.getElementById("configs-rounds-form");t.addEventListener("submit",async s=>{s.preventDefault(),new FormData(t).get("premium")==="on"?ut.show(ue):ue()})});async function ue(){const e=document.getElementById("configs-rounds-form"),t=new FormData(e);c.totalRounds=Number(t.get("rounds-number")),c.musicPos=t.get("music-pos"),c.musicPlaytime=Number(t.get("music-play-time")),c.musicsQnt=Number(t.get("music-qnt")),c.isPremiumMode=t.get("premium")==="on",c.extraTries=t.get("extra-tries")==="on",c.isPremiumMode||(c.playlist.playableIndexes=c.playlist.playableIndexes.filter(s=>{const n=c.playlist.tracks.items[s].track;return n.type==="track"?n.preview_url!==null:n.type==="episode"?n.audio_preview_url!==null:!1}),c.musicsQnt=Math.min(c.playlist.playableIndexes.length,c.musicsQnt)),await Ce(),Ie(e)}function pt(e,t){c.reset(),c.playlist=e,c.playlistId=t,Te(),T("rounds-mode-game-page")}function yt(e,t){document.getElementById("playlist-image").setAttribute("src",e.images[0].url),document.getElementById("playlist-name").innerText=e.name,e.description?document.getElementById("playlist-description").innerText=e.description:document.getElementById("playlist-description").innerText="Sem descrição",e.owner.display_name?document.getElementById("playlist-owner").innerText=e.owner.display_name:document.getElementById("playlist-owner").innerText="",document.getElementById("playlist-tracks-count").innerText=String(e.tracks.total);const s=document.getElementById("playlist-tracks-list");s.innerHTML="",s.appendChild(be(e)),document.getElementById("game-start").onclick=()=>{pt(e,t)},T("playlist-info-page")}document.addEventListener("DOMContentLoaded",()=>{var e;(e=document.getElementById("playlist-return"))==null||e.addEventListener("click",()=>{T("home-page")})});function ht(e){return e.track?e.track.is_playable:!1}async function gt(e){return fetch(`https://api.spotify.com/v1/playlists/${e}?market=${u.country}&additional_types=episode`,{method:"GET",headers:u.accessTokenHeader}).then(t=>t.json()).then(async t=>{const s={...t,playableIndexes:[]};let n=t.tracks.next,i=0;const a=[],o=[],d=l=>{ht(l)&&o.push(i),a.push(l),i++};for(t.tracks.items.forEach(d);n;)await fetch(n,{method:"GET",headers:u.accessTokenHeader}).then(l=>l.json()).then(l=>{l.items.forEach(d),n=l.next});return s.tracks.items=a,s.playableIndexes=o,s})}async function Pe(e,t){return P(gt,t,e)}function Be(e,t){const s=document.createElement("div");s.classList.add("simplified-playlist-container"),t&&s.classList.add("selectable");const n=document.createElement("img");n.classList.add("simplified-playlist-image"),e.images.length!==0&&n.setAttribute("src",e.images[0].url);const i=document.createElement("p");i.classList.add("simplified-playlist-name"),i.innerText=e.name;const a=document.createElement("p");return a.classList.add("simplified-playlist-description"),e.description?a.innerText=e.description:a.innerText=`De ${e.owner.display_name}`,s.appendChild(n),s.appendChild(i),s.appendChild(a),s}async function ft(){return fetch("https://api.spotify.com/v1/me/playlists?limit=8",{method:"GET",headers:u.accessTokenHeader}).then(e=>e.json())}async function Et(e){return P(ft,e)}async function bt(e){const s=["collaborative","description","external_urls","href","id","images","name","owner","public","snapshot_id","tracks(href,total)","type","uri"].join(",");return fetch(`https://api.spotify.com/v1/playlists/${e}?fields=${s}`,{method:"GET",headers:u.accessTokenHeader}).then(n=>n.json())}async function pe(e,t){return P(bt,t,e)}const ce=class{static savePlaylistId(t){const s=this.ids.indexOf(t);return s!==-1&&this.ids.splice(s,1),console.log(t),this.ids.unshift(t),console.log(this.ids),localStorage.setItem(this.storageName,JSON.stringify(this.ids)),s}static getPlaylistsIds(){return this.ids}};let S=ce;r(S,"storageName","play_again_playlists_ids"),r(S,"ids",JSON.parse(localStorage.getItem(ce.storageName)||"[]"));async function Ct(){return ke().then(e=>{e||console.log("Não foi possível carregar os dispositivos");const t=document.getElementById("devices-list");for(const s of e){const n=we(s);n.addEventListener("click",async()=>{if(s.id){await xe(s.id);for(let i=0;i<t.children.length;i++){const a=t.children[i];a.classList.remove("selected"),a.getElementsByClassName("device-is-selected-text")[0].innerHTML=""}n.classList.add("selected"),n.getElementsByClassName("device-is-selected-text")[0].innerHTML="Dispositivo selecionado",document.getElementById("no-device-selected").style.display="none"}}),t.appendChild(n)}e.length===0?document.getElementById("no-devices-found").style.display="block":e.some(s=>s.is_active)||(document.getElementById("no-device-selected").style.display="block")})}function J(e,t){for(const s of e){const n=Be(s,!0);n.addEventListener("click",async()=>{const i=s.id,a=await Pe(i,!0);ie(a,i)}),t.appendChild(n)}}async function vt(){return Et().then(e=>{const t=document.getElementById("user-playlists-list"),s=document.getElementById("user-playlists-load-more");J(e.items,t);let n=e.next;n?s.onclick=()=>{H(async()=>{await fetch(n,{method:"GET",headers:u.accessTokenHeader}).then(i=>i.json()).then(i=>{J(i.items,t),n=i.next,n||(s.style.display="none")})})}:s.style.display="none"})}async function ye(){const e=S.getPlaylistsIds(),t=document.getElementById("play-again-list"),s=document.getElementById("play-again-load-more"),n=8;let i=0;return Promise.all(e.slice(i,i+n).map(async a=>pe(a))).then(a=>{J(a,t),i+=n,i>=e.length?s.style.display="none":s.onclick=()=>{H(async()=>{await Promise.all(e.slice(i,i+n).map(async o=>pe(o))).then(o=>{J(o,t),i+=n,i>=e.length&&(s.style.display="none")})})}})}async function Lt(){u.isLogged?H(async()=>{await Promise.all([Ct(),vt(),ye()])}):(document.getElementById("user-library").style.display="none",document.getElementById("devices-home-page").style.display="none",H(ye))}function ie(e,t){const s=document.getElementById("play-again-list");yt(e,t);const n=S.savePlaylistId(t);n!==-1&&s.children.length>n&&s.removeChild(s.children[n]);const i=Be(e,!0);i.addEventListener("click",async()=>{ie(e,t)}),s.insertBefore(i,s.children[0])}document.addEventListener("DOMContentLoaded",async()=>{var e,t;(e=document.getElementById("playlist-form"))==null||e.addEventListener("submit",async s=>{s.preventDefault();const n=document.getElementById("playlist-input").value;try{const i=await ze(n);console.log(i);const a=await Pe(i,!0);ie(a,i)}catch(i){console.log(i)}}),(t=document.getElementById("home-btn"))==null||t.addEventListener("click",()=>{u.isLogged&&se(),T("home-page")})});const ae=new URLSearchParams(window.location.search),kt=ae.get("login")==="true",wt=ae.get("acessToken"),xt=ae.get("country");document.addEventListener("DOMContentLoaded",async()=>{T("empty-page"),u.accessToken=wt,u.country=xt,u.isLogged=kt,await Lt(),T("home-page")});async function Tt(e){try{return await(await fetch(`https://api.github.com/users/${e}`,{headers:{"X-GitHub-Api-Version":"2022-11-28"}})).json()}catch(t){return console.log(t),null}}document.addEventListener("DOMContentLoaded",()=>{var e;(e=document.getElementById("credit"))==null||e.addEventListener("click",()=>{T("credits-page"),It();const t=[{nickname:"A-nita",cargos:["Desenvolvedora"],linkedin:"https://www.linkedin.com/in/anita-moura/"},{nickname:"caiopadovan",cargos:["Desenvolvedor"],linkedin:"https://www.linkedin.com/in/caio-padovan-b28a97262/"},{nickname:"Pandxra",cargos:["Desenvolvedora"],linkedin:"https://www.linkedin.com/in/cinthiacosta98/"},{nickname:"GregorioFornetti",cargos:["Desenvolvedor"],linkedin:"https://www.linkedin.com/in/greg%C3%B3rio-fornetti-azevedo-4a0193201/"},{nickname:"guilhermesdc",cargos:["Desenvolvedor"],linkedin:"https://www.linkedin.com/in/guilherme-silva-de-camargo-104618220/"},{nickname:"N4NiNi",cargos:["Desenvolvedor"],linkedin:"https://www.linkedin.com/in/vinicius-nanini/"}],s=document.getElementById("credits_cards");for(let n of t)Tt(n.nickname).then(a=>{const o=a.name,d=a.avatar_url,l=a.html_url,m=n.linkedin,f=n.cargos[0],y=document.createElement("div"),h=document.createElement("div"),g=document.createElement("div"),p=document.createElement("div"),B=document.createElement("h5"),C=document.createElement("p"),E=document.createElement("img"),w=document.createElement("i"),D=document.createElement("i"),x=document.createElement("a"),N=document.createElement("a");x.href=l,N.href=m,g.className="position-relative",y.className="col-12 col-sm-6 col-md-4 d-flex align-items-stretch",h.className="zoomeffect cardborder mb-5 card",h.style.width="18rem",p.className="zoomeffect text-white cardcolor card-body d-flex align-items-start flex-column",B.className="cardnome h5 card-title mb-auto",C.className="cardcargo card-text my-3",E.className="p-2 card-img-top",E.setAttribute("src",d),w.className="social_icon bi bi-github fs-2 p-2",D.className="social_icon bi bi-linkedin fs-2 p-2",B.textContent=o,C.textContent=f,y.appendChild(h),h.appendChild(E),h.appendChild(p),p.appendChild(B),p.appendChild(C),p.appendChild(g),N.appendChild(D),g.appendChild(N),x.appendChild(w),g.appendChild(x),s.appendChild(y)})})});function It(){const e=document.getElementById("credits_cards");e.innerHTML=""}
